<!DOCTYPE html>
<html lang="en" xmlns="" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="ie=edge" http-equiv="x-ua-compatible">
    <title>Medical Spring</title>
    <!-- Font Awesome -->
    <link href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" rel="stylesheet">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" th:href="@{/MDB/css/bootstrap.min.css}">
    <!-- Material Design Bootstrap -->
    <link rel="stylesheet" th:href="@{/MDB/css/mdb.min.css}">
    <!-- Your custom styles (optional) -->
    <link rel="stylesheet" th:href="@{/MDB/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/tableC.css}" type="text/css"/>
</head>

<body>
<!-- Start your project here-->
<div class="pb-0 mb-0" style="height: 100vh">
    <div>
        <header class="alt" id="header" th:include="menu :: title-menu"></header>
    </div>

    <!--Main layout-->
    <main class="mt-2 mb-0 pb-0">

        <form action="#" class="md-form my-0" method="POST"
              th:action="@{/visits/{action}/addNewVisit(action='edit', backTo=${backTo})}"
              th:object="${visit}">
            <input name="visitPatientId" th:value="${patientId}" type="hidden"/>
            <input name="visitEmployeeId" th:value="${employeeId}" type="hidden"/>

            <!--            for UPDATE -->
            <input th:field="*{visitId}" type="hidden"/>

            <!--Main container-->
            <div class="container">
                <!--Grid row-->
                <div class="row">
                    <!--Grid column-->
                    <div class="col-md-4 mb-4" style="min-height: 85vh; display: flex; flex-direction: column">

                        <div class="card" style="height: auto; overflow: auto; flex: 1;">
                            <div class="text-center heavy-rain-gradient">
                                <h6 class="pb-1 pt-1 mb-0">DANE PACJENTA:</h6>
                            </div>

                            <h3 class="text-center mb-1 mt-2"
                                th:text="${visit.patient.name + ' ' + visit.patient.surname}"></h3>
                            <div class="text-center">
                                <img alt="Card image" class=" w-responsive card-img-top rounded img-fluid"
                                     id="patientImage"
                                     th:src="@{/images/avatar.png}">
                            </div>

                            <div class="card-body pt-1 pb-2 mt-2 pl-4">
                                <table class="table .w-auto" id="patientInfo">
                                    <tbody>
                                    <tr>
                                        <td class="dataType">Pesel:</td>
                                        <td class="dataValue" th:text="${visit.patient.pesel}"></td>
                                    </tr>
                                    <tr>
                                        <td class="dataType">Data:</td>
                                        <td class="dataValue" th:text="${visit.patient.birthday}"></td>
                                    </tr>
                                    <tr>
                                        <td class="dataType">Adres:</td>
                                        <td class="dataValue"
                                            th:text="${visit.patient.street + ' ' + visit.patient.houseNumber + '/' + visit.patient.apartmentNumber}"></td>
                                    </tr>
                                    <tr>
                                        <td class="dataType">Adres:</td>
                                        <td class="dataValue"
                                            th:text="${#strings.substring(visit.patient.zipCode,0,2) +'-'+ #strings.substring(visit.patient.zipCode,2,5) +', '+ visit.patient.city}"></td>
                                    </tr>
                                    <tr>
                                        <td class="dataType">Kontakt:</td>
                                        <td class="dataValue"
                                            th:text="${'+48' + visit.patient.homePhoneNumber + ',  +48' + visit.patient.workPhoneNumber}"></td>
                                    </tr>
                                    <tr>
                                        <td class="dataType">E-mail:</td>
                                        <td class="dataValue" th:text="${visit.patient.mail}"></td>
                                    </tr>
                                    <tr>
                                        <td class="dataType">Lekarz:</td>
                                        <td class="dataValue" th:text="${doctor.name + '' + doctor.surname}"></td>
                                    </tr>

                                    </tbody>


                                </table>
                            </div>
                        </div>

                        <div class="card mt-2 align-middle text-center" style="height: auto; overflow: auto;">
                            <div class="text-center heavy-rain-gradient">
                                <h6 class="pb-1 pt-1 mb-0"
                                    th:text="${#fields.hasErrors('visitDate')}? 'WSTAW DATĘ !' : 'DATA WIZYTY'">
                                </h6>
                            </div>
                            <div class="pl-3 pr-3 text-center" style="margin-left: auto; margin-right: auto">
                                <input id="visitDate1"
                                       th:class="${#fields.hasErrors('visitDate')}? 'text-centre pb-0 form-control  is-invalid' : ' text-centre pb-0 form-control'"
                                       th:field="*{visitDate}"
                                       th:required="true" type="date">
                            </div>



                            <!--                            <input id="visitDate1"-->
                            <!--                                   th:class="${#fields.hasErrors('visitDate')}? 'is-invalid form-control' : 'form-control'"-->
                            <!--                                   th:field="*{visitDate}"-->
                            <!--                                   th:unless="${visit.getVisitStatus()}"-->
                            <!--                                   type="date"/>-->
                            <!--                            <input disabled id="visitDate2" th:class="form-control" th:field="*{visitDate}"-->
                            <!--                                   th:if="${visit.getVisitStatus()}" type="date"/>-->

                            <!--                            <label class="error-sign col-form-label" th:errors="*{visitDate}"-->
                            <!--                                   th:if="${#fields.hasErrors('visitDate')}"></label>-->
                        </div>

                        <div class="card mt-2 align-middle text-center" style=" ">
                            <input class="btn btn-outline-primary" style="width: 97%" type="submit"
                                   value="Dodaj wizytę">
                            <input class="btn btn-outline-primary" onclick="history.back(-1)" style="width: 97%"
                                   type="button"
                                   value="WSTECZ"/>

                            <!--                            <a class="btn btn-outline-info waves-effect"-->
                            <!--                               th:href="@{/patients/showFormForEditPatient(patientIdToEdit=${visit.patient.patientId}, backTo='patientDetails')}">-->
                            <!--                                EDYTUJ PACJENTA-->
                            <!--                            </a>-->

                            <!--                            <a class="btn btn-outline-info waves-effect"-->
                            <!--                               th:href="@{/visits/showFormForAddVisit(patientId=${visit.patient.patientId}, backTo='patientDetails')}">-->
                            <!--                                DODAJ WIZYTĘ-->
                            <!--                            </a>-->

                            <!--                            <a class="btn btn-outline-info waves-effect" th:href="@{/patients/}">-->
                            <!--                                WSTECZ-->
                            <!--                            </a>-->
                        </div>

                    </div>
                    <!--Grid column-->

                    <div class="col-md-8 mb-4 mobileVH" style="display: flex; flex-direction: column">
                        <div class="card">
                            <div class="text-center heavy-rain-gradient">
                                <h6 class="pb-1 pt-1 mb-0">DODAJ ŚWIADCZENIE Z WYBRANEJ KATEGORII:</h6>
                            </div>

                            <div class="py-0 px-0  card-body w-100 mt-0 mb-0 ">
                                <div aria-label="..."
                                     class=" navigation py-0 px-0 flex-container btn-group btn-group-justified w-100"
                                     role="group">
                                    <!--Dropdown primary-->
                                    <div class="dropdown btn-group ml-0 mr-0"
                                         th:each="catAndTreat : ${categoryAndTreatments}">
                                        <!--Trigger-->
                                        <a aria-expanded="false" aria-haspopup="true"
                                           class=" ml-0, mr-0 btn_treatment btn btn-primary dropdown-toggle"
                                           data-toggle="dropdown"
                                           id="dropdownMenu1" th:text="${catAndTreat.key}"
                                           type="button">
                                        </a>
                                        <!--Menu-->
                                        <div class="dropdown-menu dropdown-primary">
                                            <a class="dropdown-item"
                                               th:each="treatment : ${catAndTreat.value}"
                                               th:onclick="|addTreatments(${treatment.get('treatmentId')})|"
                                               th:text="${treatment.get('treatmentName')}"
                                               th:value="${treatment.get('treatmentId')}">Action</a>
                                        </div>
                                    </div>
                                    <!--/Dropdown primary-->

                                </div>
                            </div>
                        </div>

                        <div class="mt-2 card" style="overflow: auto; flex: 1;">
                            <div class=" card text-center heavy-rain-gradient">
                                <h6 class="pb-1 pt-1 mb-0">LISTA ŚWIADCZEŃ:</h6>
                            </div>

                            <table class="table" id="treatmentTableF" th:fragment="treatmentTableF">
                                <tbody class="gradient rounded-lg pl-3 pr-3 mb-3"
                                       th:each="visitTreatment,visitTreatmentStat : ${visit.visitTreatments}">
                                <tr class="row rowMaxWajd">
                                    <!--                                    <td class=" col-sm-1 pt-1 pb-0 my-0 px-0 text-right align-middle"-->
                                    <!--                                        th:text="${visitTreatmentStat.count}">1xxx-->
                                    <!--                                    </td>-->
                                    <!--                                    onchange="checkMedicine()"-->
                                    <td class="col-sm-6 pt-2 pb-0 px-0 my-0 align-middle">
                                        <h6 class="mb-0 px-0"
                                            th:text="${visitTreatmentStat.count} + ' - '+ ${visit.visitTreatments[__${visitTreatmentStat.index}__].primaryKey.treatment.name}"></h6>

                                        <input class="diffrentTreatment"
                                               th:field="${visit.visitTreatments[__${visitTreatmentStat.index}__].primaryKey.treatment}"
                                               th:value="${visit.visitTreatments[__${visitTreatmentStat.index}__].primaryKey.treatment.treatmentId}"
                                               type="hidden">
                                    </td>

                                    <td class="col-sm-6 pt-2 pb-0 px-0 my-0 text-right">
                                        <button class="noteBadge px-1 py-1 badge " name="note"
                                                onclick="showHideNote(event)"
                                                th:id="'button' + ${visitTreatmentStat.count}"
                                                th:value="${visitTreatmentStat.count}"
                                                type="button">NOTATKA
                                        </button>

                                        <button class="px-1 py-1 badge badge-danger" name="removeRow"
                                                onclick="dellRowTreatment(event)"
                                                th:value="${visitTreatmentStat.index}"
                                                type="button">USUŃ
                                        </button>
                                    </td>
                                </tr>
                                <!--                                th:style="${visit.visitTreatments[__${visitTreatmentStat.index}__].note == ''} ? 'display:none;':''"-->
                                <tr>
                                    <td class=" borderTop py-0 mb-0" colspan="3">
                                        <div class="md-form mb-1 mt-1 ">
                                            <textarea
                                                    class="texAreaMaxWajd my-0 py-0 pl-3 pr-3 md-textarea form-control"
                                                    placeholder="...."
                                                    style="display: none; height: 26px"
                                                    th:field="${visit.visitTreatments[__${visitTreatmentStat.index}__].note}"
                                                    th:id="'note' + ${visitTreatmentStat.count}"
                                                    wrap="hard"></textarea>
                                            <!--                                            <label class="py-0 my-0" for="form7">Notatka</label>-->
                                        </div>
                                    </td>

                                </tr>

                                </tbody>
                            </table>


                        </div>
                    </div>

                </div>
                <!--Grid row-->
            </div>

        </form>


        <p class="pb-0 mb-0 text-center text-black-50"> @2019 Copyright MedicalSpring.pl</p>

    </main>


</div>
<!-- Start your project here-->

<!-- SCRIPTS -->
<!-- JQuery -->
<script th:src="@{/MDB/js/jquery-3.4.1.min.js}" type="text/javascript"></script>
<!-- Bootstrap tooltips -->
<script th:src="@{/MDB/js/popper.min.js}" type="text/javascript"></script>
<!-- Bootstrap core JavaScript -->
<script th:src="@{/MDB/js/bootstrap.min.js}" type="text/javascript"></script>
<!-- MDB core JavaScript -->
<script th:src="@{/MDB/js/mdb.min.js}" type="text/javascript"></script>

<script th:src="@{/js/addRemoveRows.js}" type="text/javascript"></script>
</body>

</html>


